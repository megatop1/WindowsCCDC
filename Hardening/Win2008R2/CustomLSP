Set-ItemProperty -Path HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced -Name HideIcons -Value 1

#Import AD Module
Import-Module ActiveDirectory

#Store password secure in memory
$newPass=Read-Host "Enter the new user password" -AsSecureString

#Change Admin Password 
Set-ADAccountPassword Administrator -NewPassword $newPass

#Disable IPv6
reg add hklm\system\currentcontrolset\services\tcpip6\parameters /v DisabledComponents /t REG_DWORD /d 0xFFFFFFFF

#Allow RDP 
Set-ItemProperty ‘HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\‘ -Name “fDenyTSConnections” -Value 0

#Force network level authentication (Harden RDP) 
Set-ItemProperty ‘HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp\‘ -Name “UserAuthentication” -Value 1

#Allow RDP Firewall
REG ADD "HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f

#Detect SMB Version (if SMB1 enabled or no value returned or SMB1=1) 
Get-Item HKLM:\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters | ForEach-Object {Get-ItemProperty $_.pspath}

#Disable SMB1
Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters" SMB1 -Type DWORD -Value 0 –Force

#Enable SMB2
Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters" SMB2 -Type DWORD -Value 1 –Force

#Disable powershell for regular users 
#Disable CMD for regular users 
#Disable local administrator
#Disable guest account
#Disable access to registry and editing reg keys 
#Disable Stickey Keys
#Disable on screen keyboard
#Disallow creation of new users 
#Disallow users being allowed to RDP 

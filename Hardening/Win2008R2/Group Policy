Import-Module ActiveDirectory
Import-Module GroupPolicy 

#The below is the name of the domain, rj, com
$domainName = 
$beforeDot = 
$AfterDot =

#Disable CMD for regular users 
New-GPO -name "DisableCMD" -domain "rj.com"
Set-GPRegistryValue -name "DisableCMD" -key "HKCU\Software\Policies\Microsoft\Windows\System" -ValueName "DisableCMD" -type Dword -value 00000002
New-GPLink -name "DisableCMD" -Target "dc=rj,dc=com" -LinkEnabled Yes 

#Disable access to registry and editing reg keys 
New-GPO -name "DisableRegAccess" -domain "rj.com"
Set-GPRegistryValue -name "DisableRegAccess" -key "HKCU\Software\Microsoft\Windows\CurrentVersion\Policies\System" -ValueName "DisableRegistryTools" -type Dword -value 00000002
New-GPLink -name "DisableRegAccess" -Target "dc=rj,dc=com" -LinkEnabled Yes 

#Disable LLMNR
New-GPO -name "DisableLLMNR" -domain "rj.com"
Set-GPRegistryValue -name "DisableLLMNR" -key "HKLM\Software\Policies\Microsoft\Windows NT\DNSClient" -ValueName "EnableMulticast" -type Dword -value 0000000
New-GPLink -name "DisableLLMNR" -Target "dc=rj,dc=com" -LinkEnabled Yes

#Disable RDP (CHECK IF RDP IS SCORED?!?!?!)
New-GPO -name "DisableRDP" -domain "rj.com"
Set-GPRegistryValue -name "DisableRDP" -key "HKLM\Software\Policies\Microsoft\Windows NT\Terminal Services" -ValueName "fDenyTSConnections" -type Dword -value 00000001
New-GPLink -name "DisableLLMNR" -Target "dc=rj,dc=com" -LinkEnabled Yes

#Disable forced system restarts after updates
New-GPO -name "DisableRestarts" -domain "rj.com"
Set-GPRegistryValue -name "DisableRestarts" -key "HKLM\Software\Policies\Microsoft\Windows\WindowsUpdate\AU" -ValueName "NoAutoRebootWithLoggedOnUsers" -type Dword -value 00000001
New-GPLink -name "DisableRestarts" -Target "dc=rj,dc=com" -LinkEnabled Yes

#Prohibit tasks being started\stopped
New-GPO -name "DisableTaskCreation" -domain "rj.com"
Set-GPRegistryValue -name "DisableTaskCreation" -key "HKLM\Software\Policies\Microsoft\Windows\Task Scheduler5.0" -ValueName "Execution" -type Dword -value 00000004
New-GPLink -name "DisableTaskCreation" -Target "dc=rj,dc=com" -LinkEnabled Yes

#Account Lockout Policy
New-GPO -name "AccountLockout" -domain "rj.com"
Set-GPRegistryValue -name "AccountLockout" -key "HKLM\Software\Policies\Microsoft\Windows\Task Scheduler5.0" -ValueName "Execution" -type Dword -value 00000004

#Disable Stickey Keys
Set-ItemProperty -Path "HKCU:\Control Panel\Accessibility\StickyKeys" -Name Flags -Value 506
Set-ItemProperty -Path "HKCU:\Control Panel\Accessibility\Keyboard Response" -Name Flags -Value 122
Set-ItemProperty -Path "HKCU:\Control Panel\Accessibility\ToggleKeys" -Name Flags -Value 58

#Disable on screen keyboard
#Disallow creation of new users 
#Disallow users being allowed to RDP 

#Disable local administrator. The below assumes you made a bat file with the following inside: net user administrator /active:no
New-GPO -name "DisableLocalAdmin" -domain "rj.com"
Set-GPRegistryValue -name "DisableLocalAdmin" -key "HKLM\Software\Microsoft\Windows\CurrentVersion\RunOnce" -ValueName "DisableLocalAdmin" -type string -value C:\Users\Administrator\Documents\disableAdmin.bat 
New-GPLink -name "DisableLocalAdmin" -Target "dc=rj,dc=com" -LinkEnabled Yes -Enforced Yes

#Disable guest account: The below assumes you made a bat file with the following inside: net user guest /active:no
New-GPO -name "DisableGuest" -domain "rj.com"
Set-GPRegistryValue -name "DisableGuest" -key "HKLM\Software\Microsoft\Windows\CurrentVersion\RunOnce" -ValueName "DisableGuest" -type string -value C:\Users\Administrator\Documents\disableGuest.bat 
New-GPLink -name "DisableLocalAdmin" -Target "dc=rj,dc=com" -LinkEnabled Yes -Enforced Yes
